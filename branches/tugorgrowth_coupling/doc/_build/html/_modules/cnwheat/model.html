<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cnwheat.model &mdash; CN-Wheat 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="CN-Wheat 0.0.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">CN-Wheat 0.0.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for cnwheat.model</h1><div class="highlight"><pre>
<span class="c"># -*- coding: latin-1 -*-</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span> <span class="c"># use &quot;//&quot; to do integer division</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cnwheat.model</span>
<span class="sd">    ~~~~~~~~~~~~~</span>

<span class="sd">    The module :mod:`cnwheat.model` defines the equations of the CN exchanges in a population of plants.</span>

<span class="sd">    :copyright: Copyright 2014-2015 INRA-ECOSYS, see AUTHORS.</span>
<span class="sd">    :license: TODO, see LICENSE for details.</span>

<span class="sd">    .. seealso:: Barillot et al. 2015.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Information about this versioned file:</span>
<span class="sd">        $LastChangedBy: rbarillot $</span>
<span class="sd">        $LastChangedDate: 2016-04-26 10:23:07 +0200 (mar., 26 avr. 2016) $</span>
<span class="sd">        $LastChangedRevision: 214 $</span>
<span class="sd">        $URL: https://subversion.renater.fr/cn-wheat/trunk/cnwheat/model.py $</span>
<span class="sd">        $Id: model.py 214 2016-04-26 08:23:07Z rbarillot $</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">parameters</span>


<div class="viewcode-block" id="Population"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Population">[docs]</a><span class="k">class</span> <span class="nc">Population</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Population` defines the CN exchanges at the population scale.</span>

<span class="sd">    A :class:`population &lt;Population&gt;` must have one or several :class:`plants &lt;Plant&gt;`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PopulationParameters</span> <span class="c">#: the internal parameters of the population</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plants</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">plants</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plants</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plants</span> <span class="o">=</span> <span class="n">plants</span> <span class="c">#: the list of plants</span>

<div class="viewcode-block" id="Population.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Population.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the integrative variables of the population recursively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">plant</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plants</span><span class="p">:</span>
            <span class="n">plant</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="Plant"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Plant">[docs]</a><span class="k">class</span> <span class="nc">Plant</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Plant` defines the CN exchanges at the plants scale.</span>

<span class="sd">    A :class:`plant &lt;Plant&gt;` must have one or several :class:`axes &lt;Axis&gt;`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PlantParameters</span> <span class="c">#: the internal parameters of the plants</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="c">#: the index of the plant</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="c">#: the list of axes</span>

<div class="viewcode-block" id="Plant.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Plant.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the integrative variables of the plant recursively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="Axis"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Axis">[docs]</a><span class="k">class</span> <span class="nc">Axis</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Axis` defines the CN exchanges at the axes scale.</span>

<span class="sd">    An :class:`axis &lt;Axis&gt;` must have:</span>
<span class="sd">        * one :class:`set of roots &lt;Roots&gt;`,</span>
<span class="sd">        * one :class:`phloem &lt;Phloem&gt;`,</span>
<span class="sd">        * zero or one :class:`set of grains &lt;Grains&gt;`,</span>
<span class="sd">        * one or several :class:`phytomer&lt;Phytomer&gt;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">AxisParameters</span> <span class="c">#: the internal parameters of the axes</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">roots</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">phloem</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">grains</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">phytomers</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="c">#: the label of the axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roots</span> <span class="o">=</span> <span class="n">roots</span> <span class="c">#: the roots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phloem</span> <span class="o">=</span> <span class="n">phloem</span> <span class="c">#: the phloem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grains</span> <span class="o">=</span> <span class="n">grains</span> <span class="c">#: the grains</span>
        <span class="k">if</span> <span class="n">phytomers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">phytomers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phytomers</span> <span class="o">=</span> <span class="n">phytomers</span> <span class="c">#: the list of phytomers</span>

<div class="viewcode-block" id="Axis.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Axis.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the integrative variables of the axis recursively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">roots</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phloem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phloem</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grains</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">phytomer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phytomers</span><span class="p">:</span>
            <span class="n">phytomer</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="Phytomer"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phytomer">[docs]</a><span class="k">class</span> <span class="nc">Phytomer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="c">#: TODO: mettre a jour la doc</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Phytomer` defines the CN exchanges at the phytomers scale.</span>

<span class="sd">    A :class:`phytomer &lt;Phytomer&gt;` must have either:</span>
<span class="sd">        * one :class:`chaff &lt;Chaff&gt;`,</span>
<span class="sd">        * OR one :class:`peduncle &lt;Peduncle&gt;`,</span>
<span class="sd">        * OR one :class:`lamina &lt;Lamina&gt;`, one :class:`internode &lt;Internode&gt;` and one :class:`sheath &lt;Sheath&gt;`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhytomerParameters</span> <span class="c">#: the internal parameters of the phytomers</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">chaff</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">peduncle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lamina</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">internode</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sheath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hiddengrowingzone</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="c">#: the index of the phytomer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chaff</span> <span class="o">=</span> <span class="n">chaff</span> <span class="c">#: the chaff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peduncle</span> <span class="o">=</span> <span class="n">peduncle</span> <span class="c">#: the peduncle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lamina</span> <span class="o">=</span> <span class="n">lamina</span> <span class="c">#: the lamina</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internode</span> <span class="o">=</span> <span class="n">internode</span> <span class="c">#: the internode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sheath</span> <span class="o">=</span> <span class="n">sheath</span> <span class="c">#: the sheath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hiddengrowingzone</span> <span class="o">=</span> <span class="n">hiddengrowingzone</span> <span class="c">#: the hidden growing zone</span>

<div class="viewcode-block" id="Phytomer.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phytomer.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the integrative variables of the phytomer recursively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chaff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chaff</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peduncle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peduncle</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lamina</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lamina</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">internode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">internode</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sheath</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="Organ"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Organ">[docs]</a><span class="k">class</span> <span class="nc">Organ</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Organ` defines the CN exchanges at the organs scale.</span>

<span class="sd">    :class:`Organ` is the base class of all organs. DO NOT INSTANTIATE IT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">OrganParameters</span> <span class="c">#: the internal parameters of the organs</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="c">#: the label of the organ</span>

<div class="viewcode-block" id="Organ.initialize"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Organ.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the derived attributes of the organ.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="Organ.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Organ.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the integrative variables of the organ recursively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</div></div>
<div class="viewcode-block" id="HiddenGrowingZone"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone">[docs]</a><span class="k">class</span> <span class="nc">HiddenGrowingZone</span><span class="p">(</span><span class="n">Organ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`HiddenGrowingZone` defines the CN exchanges in the hidden growing zone.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span> <span class="c">#: the internal parameters of the hidden growing zone</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sucrose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fructan</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mstruct</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">amino_acids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">proteins</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">HiddenGrowingZone</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c"># state variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sucrose</span> <span class="o">=</span> <span class="n">sucrose</span>                       <span class="c">#: µmol C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fructan</span> <span class="o">=</span> <span class="n">fructan</span>                       <span class="c">#: µmol C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">=</span> <span class="n">mstruct</span>                       <span class="c">#: g of CN # TODO: homogeniser avec mstruct reste modele</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amino_acids</span> <span class="o">=</span> <span class="n">amino_acids</span>               <span class="c">#: µmol N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proteins</span> <span class="o">=</span> <span class="n">proteins</span>                     <span class="c">#: µmol N</span>

        <span class="c"># FLUX PHLOEME?</span>

    <span class="c"># variables</span>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_conc_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_conc_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">,</span> <span class="n">mstruct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sucrose concentration (µmol C sucrose g-1 mstruct)</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - C sucrose (µmol C)</span>
<span class="sd">            - `mstruct` (:class:`float`) - Structural mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose concentration (µmol C g-1)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sucrose</span><span class="o">/</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_conc_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_conc_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">mstruct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amino acid concentration (µmol N amino acids g-1 mstruct)</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - N amino acids (µmol N)</span>
<span class="sd">            - `mstruct` (:class:`float`) - Structural mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino acid concentration (µmol N g-1)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">amino_acids</span><span class="o">/</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_conc_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_conc_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fructan</span><span class="p">,</span> <span class="n">mstruct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fructan concentration (µmol C fructan g-1 mstruct)</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `fructan` (:class:`float`) - C fructan (µmol C)</span>
<span class="sd">            - `mstruct` (:class:`float`) - Structural mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Fructan concentration (µmol C g-1)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">fructan</span><span class="o">/</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_conc_protein"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_conc_protein">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_protein</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proteins</span><span class="p">,</span> <span class="n">mstruct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Proteins concentration (µmol N amino acids g-1 mstruct)</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `proteins` (:class:`float`) - N proteins (µmol N)</span>
<span class="sd">            - `mstruct` (:class:`float`) - Structural mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Proteins concentration (µmol N g-1)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">proteins</span><span class="o">/</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.Regul_Sfructanes"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.Regul_Sfructanes">[docs]</a>    <span class="k">def</span> <span class="nf">Regul_Sfructanes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Unloading_Csuc_phlo</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">Vmax_Regul_Sfructans</span><span class="o">*</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">K_Regul_Sfructans</span><span class="o">**</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">n_Regul_Sfructans</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">K_Regul_Sfructans</span><span class="o">**</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">n_Regul_Sfructans</span> <span class="o">+</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="o">-</span><span class="n">Unloading_Csuc_phlo</span><span class="p">))</span><span class="o">**</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">n_Regul_Sfructans</span><span class="p">))</span>

    <span class="c"># fluxes</span></div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_unloading_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_unloading_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_unloading_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_sucrose_hidden_growing_zone</span><span class="p">,</span> <span class="n">conc_sucrose_phloem</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sucrose unloading from phloem to the hidden growing zone integrated over delta_t (µmol C sucrose unloaded g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Transport-resistance equation</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_sucrose_hidden_growing_zone` (:class:`float`) - Sucrose concentration in the hidden growing zone (µmol C g-1 mstruct)</span>
<span class="sd">            - `conc_sucrose_phloem` (:class:`float`) - Sucrose concentration in phloem (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose unloading (µmol C)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conductance</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">SIGMA</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">BETA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">conc_sucrose_phloem</span> <span class="o">-</span> <span class="n">conc_sucrose_hidden_growing_zone</span><span class="p">)</span> <span class="o">*</span> <span class="n">conductance</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_unloading_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_unloading_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_unloading_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_amino_acids_hidden_growing_zone</span><span class="p">,</span> <span class="n">conc_amino_acids_phloem</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amino acids unloading from phloem to the hidden growing zone integrated over delta_t (µmol N amino acids unloaded g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Transport-resistance equation</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_amino_acids_hidden_growing_zone` (:class:`float`) - Amino_acids concentration in the hidden growing zone (µmol N g-1 mstruct)</span>
<span class="sd">            - `conc_amino_acids_phloem` (:class:`float`) - Amino_acids concentration in phloem (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino_acids unloading (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conductance</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">SIGMA</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">BETA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">conc_amino_acids_phloem</span> <span class="o">-</span> <span class="n">conc_amino_acids_hidden_growing_zone</span><span class="p">)</span> <span class="o">*</span> <span class="n">conductance</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_s_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_s_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_sucrose</span><span class="p">,</span> <span class="n">Regul_Sfructanes_gaine</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of fructan synthesis (µmol C fructan g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Sigmoïdal function of sucrose.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_sucrose` (:class:`float`) - Sucrose concentration in the hidden growing zone (µmol C g-1 mstruct)</span>
<span class="sd">            - `Regul_Sfructanes_gaine` (:class:`float`) - TODO</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Fructan synthesis (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">conc_sucrose</span><span class="p">))</span> <span class="o">**</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">N_REGUL_SFRUCTAN</span><span class="p">)</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">Vmax_Sfructans</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">conc_sucrose</span><span class="p">))</span> <span class="o">**</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">N_REGUL_SFRUCTAN</span> <span class="o">+</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">K_SFRUCTAN</span><span class="o">**</span><span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">N_REGUL_SFRUCTAN</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta_t</span> <span class="o">*</span> <span class="n">Regul_Sfructanes_gaine</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_d_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_d_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_d_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_sucrose</span><span class="p">,</span> <span class="n">conc_fructan</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of fructan degradation (µmol C fructan g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Inhibition function by the end product i.e. sucrose (Bancal et al., 2012).</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_sucrose` (:class:`float`) - Sucrose concentration in the hidden growing zone (µmol C g-1 mstruct)</span>
<span class="sd">            - `conc_fructan` (:class:`float`) - Fructan concentration in the hidden growing zone (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Fructan degradation (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="p">(</span><span class="n">conc_fructan</span> <span class="o">/</span> <span class="p">(</span><span class="n">conc_fructan</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">D_fructan_pot</span> <span class="o">=</span> <span class="p">((</span><span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">K_DFRUCTAN</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">VMAX_DFRUCTAN</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">conc_sucrose</span> <span class="o">+</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">K_DFRUCTAN</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span> <span class="o">*</span> <span class="n">fc</span>
        <span class="k">return</span> <span class="n">D_fructan_pot</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_s_proteins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_s_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_amino_acids</span><span class="p">,</span><span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of protein synthesis (µmol N proteins s-1 g-1 MS * delta_t).</span>
<span class="sd">        Michaelis-Menten function of amino acids.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_amino_acids` (:class:`float`) - Amino acid concentration in the hidden growing zone (µmol N g-1 mstruct).</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Protein synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">VMAX_SPROTEINS</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">conc_amino_acids</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span><span class="o">.</span><span class="n">K_SPROTEINS</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">conc_amino_acids</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_d_proteins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_d_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_d_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_proteins</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of protein degradation (µmol N proteins s-1 g-1 MS * delta_t).</span>
<span class="sd">        First order kinetic</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_proteins` (:class:`float`) - Protein concentration in the hidden growing zone (µmol N g-1 mstruct).</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Protein degradation (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">parameters</span><span class="o">.</span><span class="n">HiddenGrowingZoneParameters</span><span class="o">.</span><span class="n">delta_Dproteins</span> <span class="o">*</span> <span class="n">conc_proteins</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>

    <span class="c"># compartments</span></div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_sucrose_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_sucrose_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_sucrose_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unloading_sucrose</span><span class="p">,</span> <span class="n">s_fructan</span><span class="p">,</span> <span class="n">d_fructan</span><span class="p">,</span> <span class="n">hgz_loading_sucrose_contribution</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta sucrose of hidden growing zone.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `unloading_sucrose` (:class:`float`) - Sucrose unloaded (µmol C)</span>
<span class="sd">            - `s_fructan` (:class:`float`) - Fructan synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `d_fructan` (:class:`float`) - Fructan degradation (µmol C g-1 mstruct)</span>
<span class="sd">            - `hgz_loading_sucrose_contribution` (:class:`float`) - Sucrose imported from the emerged lamina (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta sucrose (µmol C sucrose)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unloading_sucrose</span>  <span class="o">+</span> <span class="p">(</span><span class="n">d_fructan</span> <span class="o">-</span> <span class="n">s_fructan</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">+</span> <span class="n">hgz_loading_sucrose_contribution</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_amino_acids_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_amino_acids_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_amino_acids_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unloading_amino_acids</span><span class="p">,</span> <span class="n">s_proteins</span><span class="p">,</span> <span class="n">d_proteins</span><span class="p">,</span> <span class="n">hgz_loading_amino_acids_contribution</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta amino acids of hidden growing zone.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `unloading_amino_acids` (:class:`float`) - Amino acids unloaded (µmol N)</span>
<span class="sd">            - `s_proteins` (:class:`float`) - Protein synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `d_proteins` (:class:`float`) - Protein degradation (µmol N g-1 mstruct)</span>
<span class="sd">            - `hgz_loading_amino_acids_contribution` (:class:`float`) - Amino acids imported from the emerged lamina (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta amino acids (µmol N amino acids)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">unloading_amino_acids</span> <span class="o">+</span> <span class="p">(</span><span class="n">d_proteins</span> <span class="o">-</span> <span class="n">s_proteins</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">+</span> <span class="n">hgz_loading_amino_acids_contribution</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_fructan_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_fructan_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_fructan_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_fructan</span><span class="p">,</span> <span class="n">d_fructan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta fructans of hidden growing zone.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_fructan` (:class:`float`) - Fructans synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `d_fructan` (:class:`float`) - Fructans degradation (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta fructans (µmol C fructans)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_fructan</span> <span class="o">-</span> <span class="n">d_fructan</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="HiddenGrowingZone.calculate_proteins_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.HiddenGrowingZone.calculate_proteins_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_proteins_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_proteins</span><span class="p">,</span> <span class="n">d_proteins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta proteins of hidden growing zone.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_proteins` (:class:`float`) - Protein synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `d_proteins` (:class:`float`) - Protein degradation (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta proteins (µmol N proteins)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_proteins</span> <span class="o">-</span> <span class="n">d_proteins</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>
</div></div>
<div class="viewcode-block" id="Phloem"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phloem">[docs]</a><span class="k">class</span> <span class="nc">Phloem</span><span class="p">(</span><span class="n">Organ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Phloem` defines the CN exchanges in a phloem.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhloemParameters</span> <span class="c">#: the internal parameters of the phloem</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sucrose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">amino_acids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Phloem</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c"># state variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sucrose</span> <span class="o">=</span> <span class="n">sucrose</span>          <span class="c">#: µmol C sucrose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amino_acids</span> <span class="o">=</span> <span class="n">amino_acids</span>  <span class="c">#: µmol N amino acids</span>


    <span class="c"># VARIABLES</span>

<div class="viewcode-block" id="Phloem.calculate_conc_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phloem.calculate_conc_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sucrose concentration. Related to the structural dry mass of the culm</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose in phloem (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose concentration (µmol sucrose g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sucrose</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NB_C_SUCROSE</span><span class="p">)</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span>
</div>
<div class="viewcode-block" id="Phloem.calculate_conc_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phloem.calculate_conc_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amino_acids concentration. Related to the structural dry mass of the culm.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino_acids in phloem (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino_acids concentration (µmol amino_acids g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">amino_acids</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_N_RATIO</span><span class="p">)</span> <span class="o">/</span> <span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span>

    <span class="c"># COMPARTMENTS</span>
</div>
<div class="viewcode-block" id="Phloem.calculate_sucrose_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phloem.calculate_sucrose_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_sucrose_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributors</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta sucrose</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `contributors` (:class:`object`) - Organs exchanging C with the phloem</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta sucrose (µmol C sucrose)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sucrose_derivative</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">contributor</span> <span class="ow">in</span> <span class="n">contributors</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
                <span class="n">sucrose_derivative</span> <span class="o">+=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">loading_sucrose</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">Grains</span><span class="p">):</span>
                <span class="n">sucrose_derivative</span> <span class="o">-=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">s_grain_structure</span> <span class="o">+</span> <span class="p">(</span><span class="n">contributor</span><span class="o">.</span><span class="n">s_grain_starch</span> <span class="o">*</span> <span class="n">contributor</span><span class="o">.</span><span class="n">structural_dry_mass</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">Roots</span><span class="p">):</span>
                <span class="n">sucrose_derivative</span> <span class="o">-=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">unloading_sucrose</span> <span class="o">*</span> <span class="n">contributor</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">*</span> <span class="n">contributor</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">HiddenGrowingZone</span><span class="p">):</span>
                <span class="n">sucrose_derivative</span> <span class="o">-=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">unloading_sucrose</span>

        <span class="k">return</span> <span class="n">sucrose_derivative</span>
</div>
<div class="viewcode-block" id="Phloem.calculate_amino_acids_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Phloem.calculate_amino_acids_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_amino_acids_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributors</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta amino acids</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `contributors` (:class:`object`) - Organs exchanging N with the phloem</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta amino acids (µmol N amino acids)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">amino_acids_derivative</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">contributor</span> <span class="ow">in</span> <span class="n">contributors</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
                <span class="n">amino_acids_derivative</span> <span class="o">+=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">loading_amino_acids</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">Grains</span><span class="p">):</span>
                <span class="n">amino_acids_derivative</span> <span class="o">-=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">s_proteins</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">Roots</span><span class="p">):</span>
                <span class="n">amino_acids_derivative</span> <span class="o">-=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">unloading_amino_acids</span> <span class="o">*</span> <span class="n">contributor</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">*</span> <span class="n">contributor</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="n">HiddenGrowingZone</span><span class="p">):</span>
                <span class="n">amino_acids_derivative</span> <span class="o">-=</span> <span class="n">contributor</span><span class="o">.</span><span class="n">unloading_amino_acids</span>

        <span class="k">return</span> <span class="n">amino_acids_derivative</span>
</div></div>
<div class="viewcode-block" id="Grains"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains">[docs]</a><span class="k">class</span> <span class="nc">Grains</span><span class="p">(</span><span class="n">Organ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Grains` defines the CN exchanges in a set of grains.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">GrainsParameters</span> <span class="c">#: the internal parameters of the grains</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">starch</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">proteins</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Grains</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c"># state variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">starch</span> <span class="o">=</span> <span class="n">starch</span>                     <span class="c">#: µmol of C starch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">structure</span>               <span class="c">#: µmol of C sucrose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proteins</span> <span class="o">=</span> <span class="n">proteins</span>                 <span class="c">#: µmol of N proteins</span>

        <span class="c"># derived attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structural_dry_mass</span> <span class="o">=</span> <span class="bp">None</span>          <span class="c">#: g of MS</span>

        <span class="c"># fluxes from phloem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_grain_structure</span> <span class="o">=</span> <span class="bp">None</span>            <span class="c">#: current synthesis of grain structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_grain_starch</span> <span class="o">=</span> <span class="bp">None</span>               <span class="c">#: current synthesis of grain starch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_proteins</span> <span class="o">=</span> <span class="bp">None</span>                   <span class="c">#: current synthesis of grain proteins</span>

<div class="viewcode-block" id="Grains.initialize"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the derived attributes of the organ.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structural_dry_mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_structural_dry_mass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>

    <span class="c"># VARIABLES</span>
</div>
<div class="viewcode-block" id="Grains.calculate_dry_mass"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_dry_mass">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_dry_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">,</span> <span class="n">starch</span><span class="p">,</span> <span class="n">proteins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Grain total dry mass.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `structure` (:class:`float`) - Grain structural C mass (µmol C)</span>
<span class="sd">            - `starch` (:class:`float`) - Grain starch content (µmol C)</span>
<span class="sd">            - `proteins` (:class:`float`) - Grain protein content (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Grain total dry mass (g)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#: Carbohydrates mass, grain carbohydrates supposed to be mainly starch i.e. glucose polymers (C6 H12 O6)</span>
        <span class="n">C_mass</span> <span class="o">=</span> <span class="p">((</span><span class="n">structure</span> <span class="o">+</span> <span class="n">starch</span><span class="p">)</span><span class="o">*</span><span class="mf">1E-6</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">C_MOLAR_MASS</span><span class="p">)</span> <span class="o">/</span> <span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">HEXOSE_MOLAR_MASS_C_RATIO</span>

        <span class="c">#: N mass, grain proteins were supposed to be gluten mainly composed of Glu, Gln and Pro</span>
        <span class="n">N_mass</span> <span class="o">=</span> <span class="p">(</span><span class="n">proteins</span><span class="o">*</span><span class="mf">1E-6</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_MOLAR_MASS</span><span class="p">)</span> <span class="o">/</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_MOLAR_MASS_N_RATIO</span>

        <span class="k">return</span>  <span class="n">C_mass</span> <span class="o">+</span> <span class="n">N_mass</span>
</div>
<div class="viewcode-block" id="Grains.calculate_structural_dry_mass"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_structural_dry_mass">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_structural_dry_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Grain structural dry mass.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `structure` (:class:`float`) - Grain structural C mass (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Grain structural dry mass (g)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">structure</span><span class="o">*</span><span class="mf">1E-6</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">C_MOLAR_MASS</span><span class="p">)</span> <span class="o">/</span> <span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">RATIO_C_MSTRUCT</span>
</div>
<div class="viewcode-block" id="Grains.calculate_protein_N_mass"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_protein_N_mass">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_protein_N_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proteins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Grain total protein mass.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `proteins` (:class:`float`) - Grain protein content (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Grain total protein mass (g)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mass_N_proteins</span> <span class="o">=</span> <span class="n">proteins</span><span class="o">*</span><span class="mf">1E-6</span> <span class="o">*</span> <span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_MOLAR_MASS</span>                        <span class="c">#: Mass of nitrogen in proteins (g)</span>
        <span class="c">#mass_proteins = mass_N_proteins / Organ.PARAMETERS.AMINO_ACIDS_MOLAR_MASS_N_RATIO     #: Total mass of proteins (g)</span>
        <span class="k">return</span> <span class="n">mass_N_proteins</span>
</div>
<div class="viewcode-block" id="Grains.calculate_RGR_structure"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_RGR_structure">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_RGR_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Relative Growth Rate of grain structure, regulated by sucrose concentration in phloem.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Sucrose concentration in phloem (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            RGR of grain structure (dimensionless?)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span> <span class="o">*</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_RGR</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span> <span class="o">+</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_RGR</span><span class="p">)</span>


    <span class="c"># FLUXES</span>
</div>
<div class="viewcode-block" id="Grains.calculate_s_grain_structure"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_s_grain_structure">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_grain_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">prec_structure</span><span class="p">,</span> <span class="n">RGR_structure</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of grain structure synthesis integrated over delta_t (µmol C structure s-1 * delta_t).</span>
<span class="sd">        Exponential function, RGR regulated by sucrose concentration in the phloem.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `t` (:class:`float`) - Time of the simulation (s)</span>
<span class="sd">            - `prec_structure` (:class:`float`) - Grain structure at t-1 (µmol C)</span>
<span class="sd">            - `RGR_structure` (:class:`float`) - Relative Growth Rate of grain structure (dimensionless?)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Synthesis of grain structure (µmol C)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">FILLING_INIT</span><span class="p">:</span> <span class="c">#: Grain enlargment</span>
            <span class="n">s_grain_structure</span> <span class="o">=</span> <span class="n">prec_structure</span> <span class="o">*</span> <span class="n">RGR_structure</span> <span class="o">*</span> <span class="n">delta_t</span>
        <span class="k">else</span><span class="p">:</span>                                 <span class="c">#: Grain filling</span>
            <span class="n">s_grain_structure</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">s_grain_structure</span>
</div>
<div class="viewcode-block" id="Grains.calculate_s_grain_starch"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_s_grain_starch">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_grain_starch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of starch synthesis in grains (i.e. grain filling) integrated over delta_t (µmol C starch g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Michaelis-Menten function of sucrose concentration in the phloem.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `t` (:class:`float`) - Time of the simulation (s)</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Sucrose concentration in phloem (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Synthesis of grain starch (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">FILLING_INIT</span><span class="p">:</span>   <span class="c">#: Grain enlargment</span>
            <span class="n">s_grain_starch</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">t</span><span class="o">&gt;</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">FILLING_END</span><span class="p">:</span>   <span class="c">#: Grain maturity</span>
            <span class="n">s_grain_starch</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>                                    <span class="c">#: Grain filling</span>
            <span class="n">s_grain_starch</span> <span class="o">=</span> <span class="p">(((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span> <span class="o">*</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_STARCH</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span> <span class="o">+</span> <span class="n">Grains</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_STARCH</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
        <span class="k">return</span> <span class="n">s_grain_starch</span>
</div>
<div class="viewcode-block" id="Grains.calculate_s_proteins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_s_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_grain_structure</span><span class="p">,</span> <span class="n">s_grain_starch</span><span class="p">,</span> <span class="n">amino_acids_phloem</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">,</span> <span class="n">structural_dry_mass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Protein synthesis in grains integrated over delta_t.</span>
<span class="sd">        N is assumed to be co-transported along with the unloaded sucrose from phloem (using the ratio amino acids:sucrose of phloem).</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_grain_structure` (:class:`float`) - Synthesis of grain structure (µmol C)</span>
<span class="sd">            - `s_grain_starch` (:class:`float`) - Synthesis of grain starch (µmol C g-1 mstruct)</span>
<span class="sd">            - `amino_acids_phloem` (:class:`float`) - Amino acids concentration in phloem (µmol N g-1 mstruct)</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Sucrose concentration in phloem (µmol C g-1 mstruct)</span>
<span class="sd">            - `structural_dry_mass` (:class:`float`) - Grain structural dry mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Synthesis of grain proteins (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sucrose_phloem</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">s_proteins</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_grain_structure</span> <span class="o">+</span> <span class="n">s_grain_starch</span><span class="o">*</span><span class="n">structural_dry_mass</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">amino_acids_phloem</span> <span class="o">/</span> <span class="n">sucrose_phloem</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s_proteins</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">s_proteins</span>

    <span class="c"># COMPARTMENTS</span>
</div>
<div class="viewcode-block" id="Grains.calculate_structure_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_structure_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_structure_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_grain_structure</span><span class="p">,</span> <span class="n">R_growth</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta grain structure.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_grain_structure` (:class:`float`) - Synthesis of grain structure (µmol C)</span>
<span class="sd">            - `R_growth` (:class:`float`) - Grain growth respiration (µmol C respired)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta grain structure (µmol C structure)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">s_grain_structure</span> <span class="o">-</span> <span class="n">R_growth</span>
</div>
<div class="viewcode-block" id="Grains.calculate_starch_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_starch_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_starch_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_grain_starch</span><span class="p">,</span> <span class="n">structural_dry_mass</span><span class="p">,</span> <span class="n">R_growth</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta grain starch.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_grain_starch` (:class:`float`) - Synthesis of grain starch (µmol C g-1 mstruct)</span>
<span class="sd">            - `structural_dry_mass` (:class:`float`) - Grain structural dry mass (g)</span>
<span class="sd">            - `R_growth` (:class:`float`) - Grain growth respiration (µmol C respired)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta grain starch (µmol C starch)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_grain_starch</span> <span class="o">*</span> <span class="n">structural_dry_mass</span><span class="p">)</span> <span class="o">-</span> <span class="n">R_growth</span>
</div>
<div class="viewcode-block" id="Grains.calculate_proteins_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Grains.calculate_proteins_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_proteins_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_proteins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta grain proteins.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_proteins` (:class:`float`) - Synthesis of grain proteins (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta grain proteins (µmol N proteins)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">s_proteins</span>

</div></div>
<div class="viewcode-block" id="Roots"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots">[docs]</a><span class="k">class</span> <span class="nc">Roots</span><span class="p">(</span><span class="n">Organ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Roots` defines the CN exchanges in a set of roots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">RootsParameters</span> <span class="c">#: the internal parameters of the roots</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mstruct</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Nstruct</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sucrose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nitrates</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">amino_acids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cytokinins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mstruct_C_growth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">Nstruct_N_growth</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Roots</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c"># state parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstruct_C_growth</span> <span class="o">=</span> <span class="n">mstruct_C_growth</span> <span class="c">#: Growth rate of root structural dry mass (µmol C s-1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nstruct_N_growth</span> <span class="o">=</span> <span class="n">Nstruct_N_growth</span> <span class="c">#: Growth rate of root structural N mass (µmol N s-1)</span>

        <span class="c"># state variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">=</span> <span class="n">mstruct</span>                 <span class="c">#: Structural mass (g)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nstruct</span> <span class="o">=</span> <span class="n">Nstruct</span>                 <span class="c">#: Structural N mass (g)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sucrose</span> <span class="o">=</span> <span class="n">sucrose</span>                 <span class="c">#: µmol C sucrose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nitrates</span> <span class="o">=</span> <span class="n">nitrates</span>               <span class="c">#: µmol N nitrates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amino_acids</span> <span class="o">=</span> <span class="n">amino_acids</span>         <span class="c">#: µmol N amino acids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cytokinins</span> <span class="o">=</span> <span class="n">cytokinins</span>         <span class="c">#: AU cytokinins</span>

        <span class="c"># fluxes from phloem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unloading_sucrose</span> <span class="o">=</span> <span class="bp">None</span>          <span class="c">#: current unloading of sucrose from phloem to roots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unloading_amino_acids</span> <span class="o">=</span> <span class="bp">None</span>      <span class="c">#: current unloading of amino acids from phloem to roots</span>

        <span class="c"># Integrated variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_organic_nitrogen</span> <span class="o">=</span> <span class="bp">None</span>     <span class="c">#: current amount of organic N (µmol N)</span>

<div class="viewcode-block" id="Roots.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_organic_nitrogen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_total_organic_nitrogen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nstruct</span><span class="p">)</span>

    <span class="c"># VARIABLES</span>
</div>
<div class="viewcode-block" id="Roots.calculate_conc_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_conc_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sucrose concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose concentration (µmol sucrose g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sucrose</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NB_C_SUCROSE</span>
</div>
<div class="viewcode-block" id="Roots.calculate_conc_nitrates"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_conc_nitrates">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_nitrates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Nitrate concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates` (:class:`float`) - Amount of nitrates (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Nitrate concentration (µmol nitrates g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nitrates</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Roots.calculate_conc_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_conc_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amino_acid concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino_acid concentration (µmol amino_acids g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">amino_acids</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_N_RATIO</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="Roots.calculate_conc_cytokinins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_conc_cytokinins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_cytokinins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cytokinins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cytokinin concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `cytokinins` (:class:`float`) - Amount of cytokinins (AU)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            cytokinins concentration (AU cytokinins g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cytokinins</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="Roots.calculate_total_organic_nitrogen"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_total_organic_nitrogen">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_total_organic_nitrogen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">Nstruct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total amount of organic N (amino acids + Nstruct).</span>
<span class="sd">        Used to calculate residual respiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids (µmol N)</span>
<span class="sd">            - `Nstruct` (:class:`float`) -Structural N mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Total amount of organic N (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">amino_acids</span> <span class="o">+</span> <span class="p">(</span><span class="n">Nstruct</span> <span class="o">/</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_MOLAR_MASS</span><span class="p">)</span><span class="o">*</span><span class="mf">1E6</span>
</div>
<div class="viewcode-block" id="Roots.calculate_regul_transpiration"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_regul_transpiration">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_regul_transpiration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_surfacic_transpiration</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A function to regulate metabolite exports from roots by shoot transpiration</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `total_surfacic_transpiration` (:class:`float`) - Surfacic rate of total transpiration (mmol m-2 s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Dimensionless regulating factor</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">total_surfacic_transpiration</span><span class="o">/</span><span class="p">(</span><span class="n">total_surfacic_transpiration</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_TRANSPIRATION</span><span class="p">))</span>

    <span class="c"># FLUXES</span>
</div>
<div class="viewcode-block" id="Roots.calculate_unloading_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_unloading_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_unloading_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of sucrose unloading from phloem to roots integrated over delta_t (µmol C sucrose unloaded g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Michaelis-Menten function of the sucrose concentration in phloem.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Sucrose concentration in phloem (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose unloading (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span> <span class="o">*</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_SUCROSE_UNLOADING</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_SUCROSE_UNLOADING</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="Roots.calculate_unloading_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_unloading_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_unloading_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unloading_sucrose</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">,</span> <span class="n">amino_acids_phloem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unloading of amino_acids from phloem to roots integrated over delta_t.</span>
<span class="sd">        Amino acids are assumed to be co-transported along with the unloaded sucrose from phloem (using the ratio amino acids:sucrose of phloem).</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `unloading_sucrose` (:class:`float`) - Sucrose unloading (µmol C g-1 mstruct)</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Sucrose concentration in phloem (µmol C g-1 mstruct)</span>
<span class="sd">            - `amino_acids_phloem` (:class:`float`) - Amino acids concentration in phloem (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino acids unloading (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">amino_acids_phloem</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">unloading_amino_acids</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unloading_amino_acids</span> <span class="o">=</span>  <span class="n">unloading_sucrose</span> <span class="o">*</span> <span class="p">(</span><span class="n">amino_acids_phloem</span> <span class="o">/</span> <span class="n">sucrose_phloem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unloading_amino_acids</span>
</div>
<div class="viewcode-block" id="Roots.calculate_uptake_nitrates"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_uptake_nitrates">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_uptake_nitrates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conc_nitrates_soil</span><span class="p">,</span> <span class="n">nitrates_roots</span><span class="p">,</span> <span class="n">sucrose_roots</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of nitrate uptake by roots integrated over delta_t.</span>
<span class="sd">            - Nitrate uptake is calculated as the sum of the 2 transport systems: HATS and LATS</span>
<span class="sd">            - HATS and LATS parameters are calculated as a function of root nitrate concentration (negative regulation)</span>
<span class="sd">            - Nitrate uptake is finally regulated by the total culm transpiration and sucrose concentration (positive regulation)</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `conc_nitrates_soil` (:class:`float`) - Soil nitrate concentration unloading (µmol N m-3 soil)</span>
<span class="sd">            - `nitrates_roots` (:class:`float`) - Amount of nitrates in roots (µmol N)</span>
<span class="sd">            - `sucrose_roots` (:class:`float`) - Amount of sucrose in roots (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Nitrate uptake (µmol N nitrates)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#: High Affinity Transport System (HATS)</span>
        <span class="n">VMAX_HATS_MAX</span> <span class="o">=</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">A_VMAX_HATS</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">LAMBDA_VMAX_HATS</span><span class="o">*</span><span class="p">(</span><span class="n">nitrates_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">))</span>        <span class="c">#: Maximal rate of nitrates influx at saturating soil N concentration;HATS (µmol N nitrates g-1 mstruct s-1)</span>
        <span class="n">K_HATS</span> <span class="o">=</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">A_K_HATS</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">LAMBDA_K_HATS</span><span class="o">*</span><span class="p">(</span><span class="n">nitrates_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">))</span>                     <span class="c">#: Affinity coefficient of nitrates influx at saturating soil N concentration;HATS (µmol m-3)</span>
        <span class="n">HATS</span> <span class="o">=</span> <span class="p">(</span><span class="n">VMAX_HATS_MAX</span> <span class="o">*</span> <span class="n">conc_nitrates_soil</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">K_HATS</span> <span class="o">+</span> <span class="n">conc_nitrates_soil</span><span class="p">)</span>                                                     <span class="c">#: Rate of nitrate influx by HATS (µmol N nitrates uptaked s-1 g-1 mstruct)</span>

        <span class="c">#: Low Affinity Transport System (LATS)</span>
        <span class="n">K_LATS</span> <span class="o">=</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">A_LATS</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">LAMBDA_LATS</span><span class="o">*</span><span class="p">(</span><span class="n">nitrates_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">))</span>                         <span class="c">#: Rate constant for nitrates influx at low soil N concentration; LATS (m3 g-1 mstruct s-1)</span>
        <span class="n">LATS</span> <span class="o">=</span> <span class="p">(</span><span class="n">K_LATS</span> <span class="o">*</span> <span class="n">conc_nitrates_soil</span><span class="p">)</span>                                                                                           <span class="c">#: Rate of nitrate influx by LATS (µmol N nitrates uptaked s-1 g-1 mstruct)</span>
        <span class="n">HATS_LATS</span> <span class="o">=</span> <span class="p">(</span><span class="n">HATS</span> <span class="o">+</span> <span class="n">LATS</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">*</span> <span class="n">delta_t</span>                                                            <span class="c">#: Nitrate influx (µmol N)</span>

        <span class="c"># Regulations</span>
        <span class="n">regul_C</span> <span class="o">=</span> <span class="p">(</span><span class="n">sucrose_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">sucrose_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_C</span><span class="p">)</span>                                 <span class="c">#: Nitrate uptake regulation by root C</span>
        <span class="n">net_nitrate_uptake</span> <span class="o">=</span> <span class="n">HATS_LATS</span> <span class="o">*</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NET_INFLUX_UPTAKE_RATIO</span> <span class="o">*</span> <span class="n">regul_C</span>                                            <span class="c">#: Net nitrate uptake (µmol N nitrates uptaked by roots)</span>
        <span class="k">return</span> <span class="n">net_nitrate_uptake</span><span class="p">,</span> <span class="n">HATS_LATS</span>
</div>
<div class="viewcode-block" id="Roots.calculate_s_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_s_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of amino acid synthesis in roots integrated over delta_t (µmol N amino acids g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Bi-substrate Michaelis-Menten function of nitrates and sucrose.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates` (:class:`float`) - Amount of nitrates in roots (µmol N)</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose in roots (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_AMINO_ACIDS</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_AMINO_ACIDS_NITRATES</span><span class="o">/</span><span class="p">(</span><span class="n">nitrates</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_AMINO_ACIDS_SUCROSE</span><span class="o">/</span><span class="p">(</span><span class="n">sucrose</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="Roots.calculate_export_nitrates"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_export_nitrates">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_export_nitrates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates</span><span class="p">,</span> <span class="n">regul_transpiration</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total export of nitrates from roots to shoot organs integrated over delta_t.</span>
<span class="sd">        Export is calculated as a function on nitrate concentration and culm transpiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates` (:class:`float`) - Amount of nitrates in roots (µmol N)</span>
<span class="sd">            - `regul_transpiration` (:class:`float`) - Regulating factor by transpiration (mmol H2O m-2 s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Export of nitrates (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nitrates</span> <span class="o">&lt;=</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">regul_transpiration</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">export_nitrates</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f_nitrates</span> <span class="o">=</span> <span class="p">(</span><span class="n">nitrates</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_NITRATE_EXPORT</span>
            <span class="n">export_nitrates</span> <span class="o">=</span> <span class="n">f_nitrates</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">*</span> <span class="n">regul_transpiration</span> <span class="o">*</span> <span class="n">delta_t</span> <span class="c">#: Nitrate export regulation by transpiration (µmol N)</span>
        <span class="k">return</span> <span class="n">export_nitrates</span>
</div>
<div class="viewcode-block" id="Roots.calculate_export_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_export_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_export_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">regul_transpiration</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total export of amino acids from roots to shoot organs integrated over delta_t.</span>
<span class="sd">        Amino acids export is calculated as a function of nitrate export using the ratio amino acids:nitrates in roots.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids in roots (µmol N)</span>
<span class="sd">            - `regul_transpiration` (:class:`float`) - Regulating factor by transpiration (mmol H2O m-2 s-1)</span>

<span class="sd">        :Returns:</span>
<span class="sd">            Export of amino acids (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">amino_acids</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">export_amino_acids</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f_amino_acids</span> <span class="o">=</span> <span class="p">(</span><span class="n">amino_acids</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_AMINO_ACIDS_EXPORT</span>
            <span class="n">export_amino_acids</span> <span class="o">=</span> <span class="n">f_amino_acids</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">*</span> <span class="n">regul_transpiration</span> <span class="o">*</span> <span class="n">delta_t</span> <span class="c">#: Amino acids export regulation by plant transpiration (µmol N)</span>

        <span class="k">return</span> <span class="n">export_amino_acids</span>
</div>
<div class="viewcode-block" id="Roots.calculate_exudation"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_exudation">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_exudation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unloading_sucrose</span><span class="p">,</span> <span class="n">sucrose_roots</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">,</span> <span class="n">amino_acids_roots</span><span class="p">,</span> <span class="n">amino_acids_phloem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;C sucrose and N amino acids lost by root exudation integrated over delta_t (µmol C or N g-1 mstruct).</span>
<span class="sd">            - C exudation is calculated as a fraction of C unloading from phloem</span>
<span class="sd">            - N exudation is calculated from C exudation using the ratio amino acids:sucrose of the phloem</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `unloading_sucrose` (:class:`float`) - Sucrose unloading (µmol C g-1 mstruct)</span>
<span class="sd">            - `sucrose_roots` (:class:`float`) - Amount of sucrose in roots (µmol C)</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Amount of sucrose in phloem (µmol C)</span>
<span class="sd">            - `amino_acids_roots` (:class:`float`) - Amount of amino acids in roots (µmol N)</span>
<span class="sd">            - `amino_acids_phloem` (:class:`float`) - Amount of amino acids in phloem (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            C exudated, N_exudated (µmol C g-1 mstruct, µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">C_exudated</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sucrose_roots</span><span class="p">,</span> <span class="n">unloading_sucrose</span> <span class="o">*</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">C_EXUDATION</span><span class="p">)</span>           <span class="c">#: C exudated (µmol g-1 mstruct)</span>
        <span class="k">if</span> <span class="n">amino_acids_phloem</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">amino_acids_roots</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sucrose_roots</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">N_exudated</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">N_exudated</span> <span class="o">=</span> <span class="p">(</span><span class="n">amino_acids_roots</span><span class="o">/</span><span class="n">sucrose_roots</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_exudated</span>
        <span class="k">return</span> <span class="n">C_exudated</span><span class="p">,</span> <span class="n">N_exudated</span>
</div>
<div class="viewcode-block" id="Roots.calculate_mstruct_growth_cost"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_mstruct_growth_cost">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_mstruct_growth_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mstruct_C_growth</span><span class="p">,</span> <span class="n">Nstruct_N_growth</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Integrate over delta t the consumption of C and N for the growth of root mstruct</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `mstruct_C_growth` (:class:`float`) - rate of C consumption for the growth of root mstruct (µmol C s-1)</span>
<span class="sd">            - `Nstruct_N_growth` (:class:`float`) - rate of N consumption for the growth of root mstruct (µmol N s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            total_mstruct_C_growth, total_mstruct_N_growth (µmol C, µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">mstruct_C_growth</span> <span class="o">*</span> <span class="n">delta_t</span><span class="p">,</span> <span class="n">Nstruct_N_growth</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="Roots.calculate_s_cytokinins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_s_cytokinins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_cytokinins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose_roots</span><span class="p">,</span> <span class="n">nitrates_roots</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Rate of cytokinin synthesis integrated over delta_t (AU cytokinins g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Cytokinin synthesis regulated by both root sucrose and nitrates. As a signal molecule, cytokinins are assumed have a neglected effect on sucrose. Thus, no cost in C is applied to the sucrose pool.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose_roots` (:class:`float`) - Amount of sucrose in roots (µmol C)</span>
<span class="sd">            - `nitrates_roots` (:class:`float`) - Amount of nitrates in roots (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Cytokinin synthesis (AU g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conc_sucrose</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">sucrose_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">))</span>
        <span class="n">conc_nitrates</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nitrates_roots</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">))</span>
        <span class="n">f_sucrose</span> <span class="o">=</span> <span class="n">conc_sucrose</span><span class="o">**</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_SUC_CYTOKININS</span><span class="o">/</span><span class="p">(</span><span class="n">conc_sucrose</span><span class="o">**</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_SUC_CYTOKININS</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_SUCROSE_CYTOKININS</span><span class="o">**</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_SUC_CYTOKININS</span><span class="p">)</span>
        <span class="n">f_nitrates</span> <span class="o">=</span> <span class="n">conc_nitrates</span><span class="o">**</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_NIT_CYTOKININS</span><span class="o">/</span><span class="p">(</span><span class="n">conc_nitrates</span><span class="o">**</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_NIT_CYTOKININS</span> <span class="o">+</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_NITRATES_CYTOKININS</span><span class="o">**</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_NIT_CYTOKININS</span><span class="p">)</span>
        <span class="n">s_cytokinins</span> <span class="o">=</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_S_CYTOKININS</span> <span class="o">*</span> <span class="n">f_sucrose</span> <span class="o">*</span> <span class="n">f_nitrates</span> <span class="o">*</span> <span class="n">delta_t</span>
        <span class="k">return</span> <span class="n">s_cytokinins</span>
</div>
<div class="viewcode-block" id="Roots.calculate_export_cytokinins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_export_cytokinins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_export_cytokinins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cytokinins</span><span class="p">,</span> <span class="n">regul_transpiration</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total export of cytokinin from roots to shoot organs integrated over delta_t.</span>
<span class="sd">        Cytokinin export is calculated as a function of cytokinin concentration and culm transpiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `cytokinins` (:class:`float`) - Amount of cytokinins in roots (AU)</span>
<span class="sd">            - `regul_transpiration` (:class:`float`) - Regulating factor by transpiration (mmol H2O m-2 s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Cytokinin export (AU)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cytokinins</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">export_cytokinins</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f_cytokinins</span> <span class="o">=</span> <span class="p">(</span><span class="n">cytokinins</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">*</span> <span class="n">Roots</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_CYTOKININS_EXPORT</span>
            <span class="n">export_cytokinins</span> <span class="o">=</span> <span class="n">f_cytokinins</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">*</span> <span class="n">regul_transpiration</span> <span class="o">*</span> <span class="n">delta_t</span> <span class="c">#: Cytokinin export regulation by plant transpiration (AU)</span>

        <span class="k">return</span> <span class="n">export_cytokinins</span>

    <span class="c"># COMPARTMENTS</span>
</div>
<div class="viewcode-block" id="Roots.calculate_sucrose_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_sucrose_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_sucrose_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unloading_sucrose</span><span class="p">,</span> <span class="n">s_amino_acids</span><span class="p">,</span> <span class="n">mstruct_C_growth_tot</span><span class="p">,</span> <span class="n">C_exudated</span><span class="p">,</span> <span class="n">sum_respi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta root sucrose.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `unloading_sucrose` (:class:`float`) - Sucrose unloading (µmol C g-1 mstruct)</span>
<span class="sd">            - `s_amino_acids` (:class:`float`) - Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `mstruct_C_growth_tot` (:class:`float`) - Growth of root structural dry mass integrated over delta t (µmol C)</span>
<span class="sd">            - `C_exudated` (:class:`float`) - C exudation (µmol C g-1 mstruct)</span>
<span class="sd">            - `sum_respi` (:class:`float`) - Sum of respirations for roots i.e. related to N uptake, amino acids synthesis, mstruct growth and residual (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta root sucrose (µmol C sucrose)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sucrose_consumption_AA</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_amino_acids</span> <span class="o">/</span> <span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_N_RATIO</span><span class="p">)</span> <span class="o">*</span> <span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_C_RATIO</span>      <span class="c">#: Contribution of sucrose to the synthesis of amino_acids</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">unloading_sucrose</span> <span class="o">-</span> <span class="n">sucrose_consumption_AA</span> <span class="o">-</span> <span class="n">C_exudated</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">-</span> <span class="n">sum_respi</span> <span class="o">-</span> <span class="n">mstruct_C_growth_tot</span>
</div>
<div class="viewcode-block" id="Roots.calculate_nitrates_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_nitrates_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_nitrates_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uptake_nitrates</span><span class="p">,</span> <span class="n">export_nitrates</span><span class="p">,</span> <span class="n">s_amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta root nitrates.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `uptake_nitrates` (:class:`float`) - Nitrate uptake (µmol N nitrates)</span>
<span class="sd">            - `export_nitrates` (:class:`float`) - Export of nitrates (µmol N)</span>
<span class="sd">            - `s_amino_acids` (:class:`float`) - Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta root nitrates (µmol N nitrates)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">import_nitrates_roots</span> <span class="o">=</span> <span class="n">uptake_nitrates</span>
        <span class="n">nitrate_reduction_AA</span> <span class="o">=</span> <span class="n">s_amino_acids</span>                                                                                        <span class="c">#: Contribution of nitrates to the synthesis of amino_acids</span>
        <span class="k">return</span> <span class="n">import_nitrates_roots</span> <span class="o">-</span> <span class="n">export_nitrates</span> <span class="o">-</span> <span class="n">nitrate_reduction_AA</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="Roots.calculate_amino_acids_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_amino_acids_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_amino_acids_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unloading_amino_acids</span><span class="p">,</span> <span class="n">s_amino_acids</span><span class="p">,</span> <span class="n">export_amino_acids</span><span class="p">,</span> <span class="n">Nstruct_N_growth_tot</span><span class="p">,</span> <span class="n">N_exudated</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta root amino acids.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `unloading_amino_acids` (:class:`float`) - Amino acids unloading (µmol N g-1 mstruct)</span>
<span class="sd">            - `s_amino_acids` (:class:`float`) - Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `export_amino_acids` (:class:`float`) - Export of amino acids (µmol N)</span>
<span class="sd">            - `Nstruct_N_growth_tot` (:class:`float`) - Growth of root structural N mass integrated over delta t (µmol N)</span>
<span class="sd">            - `N_exudated` (:class:`float`) - N exudated (µmol g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta root amino acids (µmol N amino acids)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">unloading_amino_acids</span> <span class="o">+</span> <span class="n">s_amino_acids</span><span class="o">-</span> <span class="n">N_exudated</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">-</span> <span class="n">export_amino_acids</span> <span class="o">-</span> <span class="n">Nstruct_N_growth_tot</span>
</div>
<div class="viewcode-block" id="Roots.calculate_cytokinins_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Roots.calculate_cytokinins_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_cytokinins_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_cytokinins</span><span class="p">,</span> <span class="n">export_cytokinins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta root cytokinins.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_cytokinins` (:class:`float`) - Cytokinin synthesis (AU g-1 mstruct)</span>
<span class="sd">            - `export_cytokinins` (:class:`float`) - Cytokinin export (AU)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta root cytokinins (AU cytokinins)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">s_cytokinins</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">-</span> <span class="n">export_cytokinins</span>

</div></div>
<div class="viewcode-block" id="PhotosyntheticOrgan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrgan">[docs]</a><span class="k">class</span> <span class="nc">PhotosyntheticOrgan</span><span class="p">(</span><span class="n">Organ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`PhotosyntheticOrgan` defines the CN exchanges in a photosynthetic organ.</span>

<span class="sd">    :class:`PhotosyntheticOrgan` is the base class of all photosynthetic organs. DO NOT INSTANTIATE IT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganParameters</span> <span class="c">#: the internal parameters of the photosynthetic organs</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">exposed_element</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exposed_element</span> <span class="o">=</span> <span class="n">exposed_element</span> <span class="c">#: the exposed element</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enclosed_element</span> <span class="o">=</span> <span class="n">enclosed_element</span> <span class="c">#: the enclosed element</span>

<div class="viewcode-block" id="PhotosyntheticOrgan.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrgan.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exposed_element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">enclosed_element</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">element</span><span class="o">.</span><span class="n">calculate_integrative_variables</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrgan.calculate_total_green_area"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrgan.calculate_total_green_area">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_total_green_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the sum of the element green area belonging to the organ.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total_green_area</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exposed_element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">enclosed_element</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">total_green_area</span> <span class="o">+=</span> <span class="n">element</span><span class="o">.</span><span class="n">green_area</span>
        <span class="k">return</span> <span class="n">total_green_area</span>

</div></div>
<div class="viewcode-block" id="Chaff"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Chaff">[docs]</a><span class="k">class</span> <span class="nc">Chaff</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Chaff` defines the CN exchanges in a chaff.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">ChaffParameters</span> <span class="c">#: the internal parameters of the chaffs</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">exposed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Chaff</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">exposed_element</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Lamina"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Lamina">[docs]</a><span class="k">class</span> <span class="nc">Lamina</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Lamina` defines the CN exchanges in a lamina.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">LaminaParameters</span> <span class="c">#: the internal parameters of the laminae</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">exposed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Lamina</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">exposed_element</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Internode"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Internode">[docs]</a><span class="k">class</span> <span class="nc">Internode</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Internode` defines the CN exchanges in an internode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">InternodeParameters</span> <span class="c">#: the internal parameters of the internodes</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">exposed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Internode</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">exposed_element</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Peduncle"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Peduncle">[docs]</a><span class="k">class</span> <span class="nc">Peduncle</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Peduncle` defines the CN exchanges in a peduncle.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PeduncleParameters</span> <span class="c">#: the internal parameters of the peduncles</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">exposed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Peduncle</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">exposed_element</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Sheath"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Sheath">[docs]</a><span class="k">class</span> <span class="nc">Sheath</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Sheath` defines the CN exchanges in a sheath.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SheathParameters</span> <span class="c">#: the internal parameters of the sheaths</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">exposed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sheath</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">exposed_element</span><span class="p">,</span> <span class="n">enclosed_element</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement">[docs]</a><span class="k">class</span> <span class="nc">PhotosyntheticOrganElement</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`PhotosyntheticOrganElement` defines the CN exchanges in a photosynthetic organ element.</span>

<span class="sd">    :class:`PhotosyntheticOrganElement` is the base class of all photosynthetic organs elements. DO NOT INSTANTIATE IT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PhotosyntheticOrganElementParameters</span> <span class="c">#: the internal parameters of the photosynthetic organs elements</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">green_area</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mstruct</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Nstruct</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">triosesP</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">starch</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">sucrose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fructan</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nitrates</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">amino_acids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">proteins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cytokinins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">Tr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Ag</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Ts</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_growing</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="c">#: the label of the element</span>

        <span class="c"># state parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span> <span class="o">=</span> <span class="n">mstruct</span>               <span class="c">#: Structural dry mass (g)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nstruct</span> <span class="o">=</span> <span class="n">Nstruct</span>               <span class="c">#: Structural N mass (g)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_growing</span> <span class="o">=</span> <span class="n">is_growing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">green_area</span> <span class="o">=</span> <span class="n">green_area</span>         <span class="c">#: green area (m-2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tr</span> <span class="o">=</span> <span class="n">Tr</span>                         <span class="c">#: Transpiration rate (mmol m-2 s-1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ag</span> <span class="o">=</span> <span class="n">Ag</span>                         <span class="c">#: Gross assimilation (µmol m-2 s-1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ts</span> <span class="o">=</span> <span class="n">Ts</span>                         <span class="c">#: Organ temperature (°C)</span>

        <span class="c"># state variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">triosesP</span> <span class="o">=</span> <span class="n">triosesP</span>             <span class="c">#: µmol C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">starch</span> <span class="o">=</span> <span class="n">starch</span>                 <span class="c">#: µmol C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sucrose</span> <span class="o">=</span> <span class="n">sucrose</span>               <span class="c">#: µmol C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fructan</span> <span class="o">=</span> <span class="n">fructan</span>               <span class="c">#: µmol C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nitrates</span> <span class="o">=</span> <span class="n">nitrates</span>             <span class="c">#: µmol N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amino_acids</span> <span class="o">=</span> <span class="n">amino_acids</span>       <span class="c">#: µmol N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proteins</span> <span class="o">=</span> <span class="n">proteins</span>             <span class="c">#: µmol N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cytokinins</span> <span class="o">=</span> <span class="n">cytokinins</span>         <span class="c">#: AU</span>

        <span class="c"># fluxes to phloem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loading_sucrose</span> <span class="o">=</span> <span class="bp">None</span>          <span class="c">#: current rate of sucrose loading to phloem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loading_amino_acids</span> <span class="o">=</span> <span class="bp">None</span>      <span class="c">#: current rate of amino acids loading to phloem</span>

        <span class="c"># Integrated variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_organic_nitrogen</span> <span class="o">=</span> <span class="bp">None</span>           <span class="c">#: current total nitrogen amount (µmol N)</span>

<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_integrative_variables"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_integrative_variables">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_integrative_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the integrative variables of the element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_organic_nitrogen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_total_organic_nitrogen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">proteins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nstruct</span><span class="p">)</span>

    <span class="c"># VARIABLES</span></div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_photosynthesis"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_photosynthesis">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_photosynthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ag</span><span class="p">,</span> <span class="n">green_area</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total photosynthesis of an element integrated over delta_t (µmol C m-2 s-1 * m2 * delta_t).</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `Ag` (:class:`float`) - Gross photosynthesis rate (µmol C m-2 s-1)</span>
<span class="sd">            - `green_area` (:class:`float`) - Green area (m2)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Total photosynthesis (µmol C)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Ag</span> <span class="o">*</span> <span class="n">green_area</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_total_transpiration"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_total_transpiration">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_total_transpiration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tr</span><span class="p">,</span> <span class="n">green_area</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Surfacic transpiration rate of an element</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `Tr` (:class:`float`) - Transpiration rate (mmol H2O m-2 s-1)</span>
<span class="sd">            - `green_area` (:class:`float`) - Green area (m2)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Total transpiration (mmol H2O s-1)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">green_area</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_triosesP"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_triosesP">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_triosesP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Triose Phosphates concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `triosesP` (:class:`float`) - Amount of triose phosphates (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Triose phosphates concentration (µmol triosesP g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">triosesP</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NB_C_TRIOSEP</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sucrose concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose concentration (µmol sucrose g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sucrose</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NB_C_SUCROSE</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_starch"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_starch">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_starch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starch concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `starch` (:class:`float`) - Amount of sucrose (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Starch concentration (µmol starch g-1 mstruct, eq. glucose).</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">starch</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NB_C_HEXOSES</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fructan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fructan concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `fructan` (:class:`float`) - Amount of fructan (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Fructan concentration (µmol fructan g-1 mstruct, eq. glucose).</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">fructan</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span><span class="o">/</span><span class="n">Organ</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">NB_C_HEXOSES</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_regul_s_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_regul_s_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_regul_s_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loading_sucrose</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Regulating function for fructan maximal rate of synthesis.</span>
<span class="sd">        Negative regulation by the loading of sucrose from the phloem (&quot;swith-off&quot; sigmoïdal kinetic).</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `loading_sucrose` (:class:`float`) - Sucrose loading (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Maximal rate of fructan synthesis (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">loading_sucrose</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">Vmax_Sfructans</span> <span class="o">=</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_SFRUCTAN_POT</span>
        <span class="k">else</span><span class="p">:</span> <span class="c"># Regulation by sucrose loading</span>
            <span class="n">rate_loading_sucrose_massic</span> <span class="o">=</span> <span class="n">loading_sucrose</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">/</span><span class="n">delta_t</span>
            <span class="n">Vmax_Sfructans</span> <span class="o">=</span> <span class="p">((</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_SFRUCTAN_POT</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_REGUL_SFRUCTAN</span><span class="o">**</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_REGUL_SFRUCTAN</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rate_loading_sucrose_massic</span><span class="o">**</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_REGUL_SFRUCTAN</span><span class="p">))</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_REGUL_SFRUCTAN</span><span class="o">**</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_REGUL_SFRUCTAN</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">Vmax_Sfructans</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_nitrates"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_nitrates">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_nitrates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Nitrate concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates` (:class:`float`) - Amount of nitrates (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Nitrate concentration (µmol nitrates g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nitrates</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amino_acid concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino_acid concentration (µmol amino acids g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">amino_acids</span><span class="o">/</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_N_RATIO</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_proteins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proteins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Protein concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `proteins` (:class:`float`) - Amount of proteins (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Protein concentration (g proteins g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mass_N_proteins</span> <span class="o">=</span> <span class="n">proteins</span><span class="o">*</span><span class="mf">1E-6</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_MOLAR_MASS</span>                        <span class="c">#: Mass of N in proteins (g)</span>
        <span class="n">mass_proteins</span> <span class="o">=</span> <span class="n">mass_N_proteins</span> <span class="o">/</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_MOLAR_MASS_N_RATIO</span>      <span class="c">#: Total mass of proteins (g)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">mass_proteins</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_total_organic_nitrogen"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_total_organic_nitrogen">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_total_organic_nitrogen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">proteins</span><span class="p">,</span> <span class="n">Nstruct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total amount of organic N (amino acids + proteins + Nstruct).</span>
<span class="sd">        Used to calculate residual respiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids (µmol N)</span>
<span class="sd">            - `proteins` (:class:`float`) - Amount of proteins (µmol N)</span>
<span class="sd">            - `Nstruct` (:class:`float`) - Structural N mass (g)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Total amount of organic N (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">amino_acids</span> <span class="o">+</span> <span class="n">proteins</span> <span class="o">+</span> <span class="p">(</span><span class="n">Nstruct</span> <span class="o">/</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_MOLAR_MASS</span><span class="p">)</span><span class="o">*</span><span class="mf">1E6</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_conc_cytokinins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_conc_cytokinins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_cytokinins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cytokinins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cytokinin concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `cytokinins` (:class:`float`) - Amount of cytokinins (AU)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Cytokinin concentration (AU g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cytokinins</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span>

    <span class="c"># FLUXES</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_s_starch"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_s_starch">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_starch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of starch synthesis (µmol C starch g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Michaelis-Menten function of triose phosphates.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `triosesP` (:class:`float`) - Amount of triose phosphates (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Starch synthesis (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_STARCH</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_STARCH</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_d_starch"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_d_starch">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_d_starch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starch</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of starch degradation (µmol C starch g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        First order kinetic.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `starch` (:class:`float`) - Amount of starch (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Starch degradation (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">DELTA_DSTARCH</span> <span class="o">*</span> <span class="p">(</span><span class="n">starch</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_s_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_s_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of sucrose synthesis (µmol C sucrose g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Michaelis-Menten function of triose phosphates.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `triosesP` (:class:`float`) - Amount of triose phosphates (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose synthesis (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">triosesP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_SUCROSE</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_SUCROSE</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_loading_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_loading_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_loading_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">,</span> <span class="n">sucrose_phloem</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of sucrose loading to phloem (µmol C sucrose s-1 * delta_t).</span>
<span class="sd">        Transport-resistance model.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose in the element (µmol C)</span>
<span class="sd">            - `sucrose_phloem` (:class:`float`) - Amount of sucrose in the phloem (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose loading (µmol C)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conc_sucrose_element</span> <span class="o">=</span> <span class="n">sucrose</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
        <span class="n">conc_sucrose_phloem</span>  <span class="o">=</span> <span class="n">sucrose_phloem</span> <span class="o">/</span> <span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">OrganParameters</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">)</span>
        <span class="c">#: Driving compartment (µmol C g-1 mstruct)</span>
        <span class="n">driving_sucrose_compartment</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">conc_sucrose_element</span><span class="p">,</span> <span class="n">conc_sucrose_phloem</span><span class="p">)</span>
        <span class="c">#: Gradient of sucrose between the element and the phloem (µmol C g-1 mstruct)</span>
        <span class="n">diff_sucrose</span> <span class="o">=</span> <span class="n">conc_sucrose_element</span> <span class="o">-</span> <span class="n">conc_sucrose_phloem</span>
        <span class="c">#: Conductance depending on mstruct (g2 µmol-1 s-1)</span>
        <span class="n">conductance</span> <span class="o">=</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">SIGMA_SUCROSE</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">BETA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">driving_sucrose_compartment</span> <span class="o">*</span> <span class="n">diff_sucrose</span> <span class="o">*</span> <span class="n">conductance</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_export_sucrose"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_export_sucrose">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_export_sucrose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">,</span> <span class="n">conc_sucrose_hgz</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of sucrose exportation to hidden growing zone (µmol C sucrose s-1 * delta_t).</span>
<span class="sd">        Transport-resistance model.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose in the element (µmol C)</span>
<span class="sd">            - `conc_sucrose_hgz` (:class:`float`) - Sucrose concentration in the hidden growing zone (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Sucrose export (µmol C)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conc_sucrose_element</span> <span class="o">=</span> <span class="n">sucrose</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
        <span class="c">#: Gradient of sucrose between the element and the hidden growing zone (µmol C g-1 mstruct)</span>
        <span class="n">diff_sucrose</span> <span class="o">=</span> <span class="n">conc_sucrose_element</span> <span class="o">-</span> <span class="n">conc_sucrose_hgz</span>
        <span class="c">#: Conductance depending on mstruct</span>
        <span class="n">conductance</span> <span class="o">=</span> <span class="n">HiddenGrowingZone</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">SIGMA</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">BETA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">diff_sucrose</span> <span class="o">*</span> <span class="n">conductance</span> <span class="o">*</span> <span class="n">delta_t</span>

</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_s_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_s_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">,</span> <span class="n">regul_s_fructan</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of fructan synthesis (µmol C fructan g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Sigmoïdal function of sucrose.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose (µmol C)</span>
<span class="sd">            - `regul_s_fructan` (:class:`float`) - Maximal rate of fructan synthesis regulated by sucrose loading (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Fructan synthesis (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">*</span> <span class="n">regul_s_fructan</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_SFRUCTAN</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta_t</span>

</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_d_fructan"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_d_fructan">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_d_fructan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">,</span> <span class="n">fructan</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of fructan degradation (µmol C fructan g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        Inhibition function by the end product i.e. sucrose (Bancal et al., 2012).</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `sucrose` (:class:`float`) - Amount of sucrose (µmol C)</span>
<span class="sd">            - `fructan` (:class:`float`) - Amount of fructan (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Fructan degradation (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d_potential</span> <span class="o">=</span> <span class="p">((</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_DFRUCTAN</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_DFRUCTAN</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sucrose</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_DFRUCTAN</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
        <span class="n">d_actual</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">d_potential</span> <span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fructan</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">d_actual</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_nitrates_import"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_nitrates_import">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_nitrates_import</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roots_uptake_nitrates</span><span class="p">,</span> <span class="n">roots_export_nitrates</span><span class="p">,</span> <span class="n">element_transpiration</span><span class="p">,</span> <span class="n">total_transpiration</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total nitrates imported from roots (µmol N nitrates integrated over delta_t).</span>
<span class="sd">        Nitrates coming from roots (fraction of uptake + direct export) are distributed according to the contribution of the element to culm transpiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `roots_uptake_nitrates` (:class:`float`) - Nitrate uptake by roots (µmol N)</span>
<span class="sd">            - `roots_export_nitrates` (:class:`float`) - Exported nitrates by roots (µmol N)</span>
<span class="sd">            - `element_transpiration` (:class:`float`) - Element transpiration (mmol H2O s-1)</span>
<span class="sd">            - `total_transpiration` (:class:`float`) - Culm transpiration (mmol H2O s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Total nitrates import (µmol N nitrates)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">total_transpiration</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">nitrates_import</span> <span class="o">=</span> <span class="n">roots_export_nitrates</span> <span class="o">*</span> <span class="p">(</span><span class="n">element_transpiration</span><span class="o">/</span><span class="n">total_transpiration</span><span class="p">)</span>      <span class="c">#: Proportion of exported nitrates from roots to element</span>
        <span class="k">else</span><span class="p">:</span> <span class="c"># Avoids further float division by zero error</span>
            <span class="n">nitrates_import</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">nitrates_import</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_amino_acids_import"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_amino_acids_import">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_amino_acids_import</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roots_exported_amino_acids</span><span class="p">,</span> <span class="n">element_transpiration</span><span class="p">,</span> <span class="n">total_transpiration</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total amino acids imported from roots  (µmol N amino acids integrated over delta_t).</span>
<span class="sd">        Amino acids exported by roots are distributed according to the contribution of the element to culm transpiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `roots_exported_amino_acids` (:class:`float`) - Exported amino acids by roots (µmol N)</span>
<span class="sd">            - `element_transpiration` (:class:`float`) - Element transpiration (mmol H2O s-1)</span>
<span class="sd">            - `total_transpiration` (:class:`float`) - Culm transpiration (mmol H2O s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Total amino acids import (µmol N amino acids)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">total_transpiration</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">amino_acids_import</span> <span class="o">=</span> <span class="n">roots_exported_amino_acids</span> <span class="o">*</span> <span class="p">(</span><span class="n">element_transpiration</span><span class="o">/</span><span class="n">total_transpiration</span><span class="p">)</span> <span class="c">#: Proportion of exported amino acids from roots to organ</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">amino_acids_import</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">amino_acids_import</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_s_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_s_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates</span><span class="p">,</span> <span class="n">triosesP</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of amino acids synthesis (µmol N amino acids s-1 g-1 MS * delta_t).</span>
<span class="sd">        Bi-substrate Michaelis-Menten function of nitrates and triose phosphates.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates` (:class:`float`) - Amount of nitrates (µmol N)</span>
<span class="sd">            - `triosesP` (:class:`float`) - Amount of triosesP (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nitrates</span> <span class="o">&lt;=</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">triosesP</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">calculate_s_amino_acids</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">calculate_s_amino_acids</span> <span class="o">=</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_AMINO_ACIDS</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_AMINO_ACIDS_NITRATES</span><span class="o">/</span><span class="p">(</span><span class="n">nitrates</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_AMINO_ACIDS_TRIOSESP</span><span class="o">/</span><span class="p">(</span><span class="n">triosesP</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))))</span> <span class="o">*</span> <span class="n">delta_t</span>
        <span class="k">return</span> <span class="n">calculate_s_amino_acids</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_s_proteins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_s_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_s_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of protein synthesis (µmol N proteins s-1 g-1 MS * delta_t).</span>
<span class="sd">        Michaelis-Menten function of amino acids.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids (µmol N).</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Protein synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">calculate_s_proteins</span> <span class="o">=</span> <span class="p">(((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">amino_acids</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_SPROTEINS</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">))</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_SPROTEINS</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_t</span>
        <span class="k">return</span> <span class="n">calculate_s_proteins</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_d_proteins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_d_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_d_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proteins</span><span class="p">,</span> <span class="n">cytokinins</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of protein degradation (µmol N proteins s-1 g-1 MS * delta_t).</span>
<span class="sd">        First order kinetic regulated by cytokinins concentration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `proteins` (:class:`float`) - Amount of proteins (µmol N)</span>
<span class="sd">            - `cytokinins` (:class:`float`) - Amount of cytokinins (AU)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Protein degradation (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conc_cytokinins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">cytokinins</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">VMAX_DPROTEINS</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_DPROTEINS</span><span class="o">**</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_DPROTEINS</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">conc_cytokinins</span><span class="o">**</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_DPROTEINS</span> <span class="o">+</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">K_DPROTEINS</span><span class="o">**</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">N_DPROTEINS</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">k</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">proteins</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)))</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_loading_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_loading_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_loading_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">amino_acids_phloem</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of amino acids loading to phloem (µmol N amino acids s-1 * delta_t).</span>
<span class="sd">        Transport-resistance model.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids in the element (µmol N)</span>
<span class="sd">            - `amino_acids_phloem` (:class:`float`) - Amount of amino acids in the phloem (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino acids loading (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#: Driving compartment (µmol N g-1 mstruct)</span>
        <span class="n">driving_amino_acids_compartment</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">amino_acids</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">),</span> <span class="n">amino_acids_phloem</span><span class="o">/</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">parameters</span><span class="o">.</span><span class="n">OrganParameters</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">))</span>
        <span class="c">#: Gradient of amino acids between the element and the phloem (µmol N g-1 mstruct)</span>
        <span class="n">diff_amino_acids</span> <span class="o">=</span> <span class="n">amino_acids</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span> <span class="o">-</span> <span class="n">amino_acids_phloem</span><span class="o">/</span><span class="p">(</span><span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">MSTRUCT_AXIS</span><span class="o">*</span><span class="n">parameters</span><span class="o">.</span><span class="n">OrganParameters</span><span class="o">.</span><span class="n">ALPHA_AXIS</span><span class="p">)</span>
        <span class="c">#: Conductance depending on mstruct (g2 µmol-1 s-1)</span>
        <span class="n">conductance</span> <span class="o">=</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">SIGMA_AMINO_ACIDS</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">BETA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">driving_amino_acids_compartment</span> <span class="o">*</span> <span class="n">diff_amino_acids</span> <span class="o">*</span> <span class="n">conductance</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_export_amino_acids"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_export_amino_acids">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_export_amino_acids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids</span><span class="p">,</span> <span class="n">conc_amino_acids_hgz</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of amino acids exportation to hidden growing zone (µmol N amino acids s-1 * delta_t).</span>
<span class="sd">        Transport-resistance model.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids` (:class:`float`) - Amount of amino acids in the element (µmol N)</span>
<span class="sd">            - `conc_amino_acids_hgz` (:class:`float`) - Amino acids concentration in the hidden growing zone (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Amino acids export (µmol N)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conc_amino_acids_element</span> <span class="o">=</span> <span class="n">amino_acids</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
        <span class="c">#: Gradient of amino acids between the element and the hidden growing zone (µmol N g-1 mstruct)</span>
        <span class="n">diff_amino_acids</span> <span class="o">=</span> <span class="n">conc_amino_acids_element</span> <span class="o">-</span> <span class="n">conc_amino_acids_hgz</span>
        <span class="c">#: Conductance depending on mstruct</span>
        <span class="n">conductance</span> <span class="o">=</span> <span class="n">HiddenGrowingZone</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">SIGMA</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">BETA</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">diff_amino_acids</span> <span class="o">*</span> <span class="n">conductance</span> <span class="o">*</span> <span class="n">delta_t</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_cytokinins_import"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_cytokinins_import">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_cytokinins_import</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roots_exported_cytokinins</span><span class="p">,</span> <span class="n">element_transpiration</span><span class="p">,</span> <span class="n">total_transpiration</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Import of cytokinins (AU cytokinins integrated over delta_t).</span>
<span class="sd">        Cytokinin exported by roots are distributed according to the contribution of the element to culm transpiration.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `roots_exported_cytokinins` (:class:`float`) - Exported cytokinins from roots (AU)</span>
<span class="sd">            - `element_transpiration` (:class:`float`) - Element transpiration (mmol H2O s-1)</span>
<span class="sd">            - `total_transpiration` (:class:`float`) - Culm transpiration (mmol H2O s-1)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Cytokinin import (AU)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">total_transpiration</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">cytokinins_import</span> <span class="o">=</span> <span class="n">roots_exported_cytokinins</span> <span class="o">*</span> <span class="p">(</span><span class="n">element_transpiration</span><span class="o">/</span><span class="n">total_transpiration</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cytokinins_import</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">cytokinins_import</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_d_cytokinins"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_d_cytokinins">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_d_cytokinins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cytokinins</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rate of cytokinins degradation integrated over delta_t (AU g-1 mstruct s-1 * delta_t).</span>
<span class="sd">        First order kinetic.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `cytokinins` (:class:`float`) - Amount of cytokinins (AU)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Cytokinin degradation (AU g-1 mstruct)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">DELTA_D_CYTOKININS</span> <span class="o">*</span> <span class="p">(</span><span class="n">cytokinins</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)))</span> <span class="o">*</span> <span class="n">delta_t</span>

    <span class="c"># COMPARTMENTS</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_triosesP_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_triosesP_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_triosesP_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">photosynthesis</span><span class="p">,</span> <span class="n">s_sucrose</span><span class="p">,</span> <span class="n">s_starch</span><span class="p">,</span> <span class="n">s_amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delta triose phosphates of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `photosynthesis` (:class:`float`) - Total gross photosynthesis (µmol C)</span>
<span class="sd">            - `s_sucrose` (:class:`float`) - Sucrose synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `s_starch` (:class:`float`) - Starch synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `s_amino_acids` (:class:`float`) - Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta triose phosphates (µmol C triose phosphates)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">triosesP_consumption_AA</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_amino_acids</span> <span class="o">/</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_N_RATIO</span><span class="p">)</span> <span class="o">*</span> <span class="n">PhotosyntheticOrgan</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">AMINO_ACIDS_C_RATIO</span> <span class="c">#: Contribution of triosesP to the synthesis of amino_acids</span>
        <span class="k">return</span> <span class="n">photosynthesis</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_sucrose</span> <span class="o">+</span> <span class="n">s_starch</span> <span class="o">+</span> <span class="n">triosesP_consumption_AA</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_starch_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_starch_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_starch_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_starch</span><span class="p">,</span> <span class="n">d_starch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta starch of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_starch` (:class:`float`) - Starch synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `d_starch` (:class:`float`) - Starch degradation (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta starch (µmol C starch)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_starch</span> <span class="o">-</span> <span class="n">d_starch</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_sucrose_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_sucrose_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_sucrose_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_sucrose</span><span class="p">,</span> <span class="n">d_starch</span><span class="p">,</span> <span class="n">loading_sucrose</span><span class="p">,</span> <span class="n">s_fructan</span><span class="p">,</span> <span class="n">d_fructan</span><span class="p">,</span> <span class="n">sum_respi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta sucrose of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_sucrose` (:class:`float`) - Sucrose synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `d_starch` (:class:`float`) - Starch degradation (µmol C g-1 mstruct)</span>
<span class="sd">            - `loading_sucrose` (:class:`float`) - Sucrose loading (µmol C)</span>
<span class="sd">            - `s_fructan` (:class:`float`) - Fructan synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `d_fructan` (:class:`float`) - Fructan degradation (µmol C g-1 mstruct)</span>
<span class="sd">            - `sum_respi` (:class:`float`) - Sum of respirations for the element i.e. related to C loading to phloem, amino acids synthesis and residual (µmol C)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta sucrose (µmol C sucrose)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_sucrose</span> <span class="o">+</span> <span class="n">d_starch</span> <span class="o">+</span> <span class="n">d_fructan</span> <span class="o">-</span> <span class="n">s_fructan</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="p">)</span> <span class="o">-</span> <span class="n">sum_respi</span> <span class="o">-</span> <span class="n">loading_sucrose</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_fructan_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_fructan_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_fructan_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_fructan</span><span class="p">,</span> <span class="n">d_fructan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta fructan of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_fructan` (:class:`float`) - Fructan synthesis (µmol C g-1 mstruct)</span>
<span class="sd">            - `d_fructan` (:class:`float`) - Fructan degradation (µmol C g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta fructan (µmol C fructan)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_fructan</span> <span class="o">-</span> <span class="n">d_fructan</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_nitrates_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_nitrates_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_nitrates_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates_import</span><span class="p">,</span> <span class="n">s_amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta nitrates of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates_import` (:class:`float`) - Nitrate import from roots (µmol N)</span>
<span class="sd">            - `s_amino_acids` (:class:`float`) - Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta nitrates (µmol N nitrates)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nitrate_reduction_AA</span> <span class="o">=</span> <span class="n">s_amino_acids</span>  <span class="c">#: Contribution of nitrates to the synthesis of amino_acids</span>
        <span class="k">return</span> <span class="n">nitrates_import</span> <span class="o">-</span> <span class="p">(</span><span class="n">nitrate_reduction_AA</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_amino_acids_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_amino_acids_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_amino_acids_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amino_acids_import</span><span class="p">,</span> <span class="n">s_amino_acids</span><span class="p">,</span> <span class="n">s_proteins</span><span class="p">,</span> <span class="n">d_proteins</span><span class="p">,</span> <span class="n">loading_amino_acids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta amino acids of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `amino_acids_import` (:class:`float`) - Amino acids import from roots (µmol N)</span>
<span class="sd">            - `s_amino_acids` (:class:`float`) - Amino acids synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `s_proteins` (:class:`float`) - Protein synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `d_proteins` (:class:`float`) - Protein degradation (µmol N g-1 mstruct)</span>
<span class="sd">            - `loading_amino_acids` (:class:`float`) - Amino acids loading (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta amino acids (µmol N amino acids)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">amino_acids_import</span> <span class="o">-</span> <span class="n">loading_amino_acids</span> <span class="o">+</span> <span class="p">(</span><span class="n">s_amino_acids</span> <span class="o">+</span> <span class="n">d_proteins</span> <span class="o">-</span> <span class="n">s_proteins</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_proteins_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_proteins_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_proteins_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s_proteins</span><span class="p">,</span> <span class="n">d_proteins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta proteins of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `s_proteins` (:class:`float`) - Protein synthesis (µmol N g-1 mstruct)</span>
<span class="sd">            - `d_proteins` (:class:`float`) - Protein degradation (µmol N g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta proteins (µmol N proteins)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">s_proteins</span> <span class="o">-</span> <span class="n">d_proteins</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhotosyntheticOrganElement.calculate_cytokinins_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PhotosyntheticOrganElement.calculate_cytokinins_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_cytokinins_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">import_cytokinins</span><span class="p">,</span> <span class="n">d_cytokinins</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta cytokinins of element.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `import_cytokinins` (:class:`float`) - Cytokinin import (AU)</span>
<span class="sd">            - `d_cytokinins` (:class:`float`) - Cytokinin degradation (AU g-1 mstruct)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta cytokinins (AU cytokinins)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">import_cytokinins</span> <span class="o">-</span> <span class="n">d_cytokinins</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstruct</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">PARAMETERS</span><span class="o">.</span><span class="n">ALPHA</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="ChaffElement"><a class="viewcode-back" href="../../ref.html#cnwheat.model.ChaffElement">[docs]</a><span class="k">class</span> <span class="nc">ChaffElement</span><span class="p">(</span><span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`ChaffElement` defines the CN exchanges in a chaff element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">ChaffElementParameters</span> <span class="c">#: the internal parameters of the chaffs elements</span>

</div>
<div class="viewcode-block" id="LaminaElement"><a class="viewcode-back" href="../../ref.html#cnwheat.model.LaminaElement">[docs]</a><span class="k">class</span> <span class="nc">LaminaElement</span><span class="p">(</span><span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`LaminaElement` defines the CN exchanges in a lamina element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">LaminaElementParameters</span> <span class="c">#: the internal parameters of the laminae elements</span>
</div>
<div class="viewcode-block" id="InternodeElement"><a class="viewcode-back" href="../../ref.html#cnwheat.model.InternodeElement">[docs]</a><span class="k">class</span> <span class="nc">InternodeElement</span><span class="p">(</span><span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`InternodeElement` defines the CN exchanges in an internode element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">InternodeElementParameters</span> <span class="c">#: the internal parameters of the internodes elements</span>

</div>
<div class="viewcode-block" id="PeduncleElement"><a class="viewcode-back" href="../../ref.html#cnwheat.model.PeduncleElement">[docs]</a><span class="k">class</span> <span class="nc">PeduncleElement</span><span class="p">(</span><span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`PeduncleElement` defines the CN exchanges in a peduncle element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">PeduncleElementParameters</span> <span class="c">#: the internal parameters of the peduncles elements</span>

</div>
<div class="viewcode-block" id="SheathElement"><a class="viewcode-back" href="../../ref.html#cnwheat.model.SheathElement">[docs]</a><span class="k">class</span> <span class="nc">SheathElement</span><span class="p">(</span><span class="n">PhotosyntheticOrganElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`SheathElement` defines the CN exchanges in a sheath element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SheathElementParameters</span> <span class="c">#: the internal parameters of the sheaths elements</span>

</div>
<div class="viewcode-block" id="Soil"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Soil">[docs]</a><span class="k">class</span> <span class="nc">Soil</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The class :class:`Soil` defines the amount of nitrogen in the volume of soil explored by roots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SoilParameters</span> <span class="c">#: the internal parameters of the soil</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nitrates</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Tsoil</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="c"># variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span>                   <span class="c">#: Volume of soil explored by roots (m3)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nitrates</span> <span class="o">=</span> <span class="n">nitrates</span>               <span class="c">#: µmol N nitrates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tsoil</span> <span class="o">=</span> <span class="n">Tsoil</span>                     <span class="c">#: soil temperature (°C)</span>

    <span class="c"># VARIABLES</span>

<div class="viewcode-block" id="Soil.calculate_conc_nitrates"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Soil.calculate_conc_nitrates">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conc_nitrates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nitrates</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Nitrate concentration in soil.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `nitrates` (:class:`float`) - Amount of nitrates (µmol N)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Nitrate concentration (µmol nitrates m-3)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nitrates</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">))</span>

    <span class="c"># FLUX</span></div>
<div class="viewcode-block" id="Soil.calculate_mineralisation"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Soil.calculate_mineralisation">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_mineralisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Mineralisation on organic N into nitrates in soil.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `t` (:class:`float`) - Time of the simulation (s)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            Nitrate mineralisation (µmol)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SoilParameters</span><span class="o">.</span><span class="n">MINERALISATION_RATE</span> <span class="o">*</span> <span class="n">delta_t</span>

    <span class="c"># COMPARTMENTS</span>
</div>
<div class="viewcode-block" id="Soil.calculate_nitrates_derivative"><a class="viewcode-back" href="../../ref.html#cnwheat.model.Soil.calculate_nitrates_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_nitrates_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mineralisation</span><span class="p">,</span> <span class="n">uptake_nitrates</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;delta soil nitrates.</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - `mineralisation` (:class:`float`) - N mineralisation in soil (µmol m-2 N nitrates)</span>
<span class="sd">            - `uptake_nitrates` (:class:`float`) - Nitrate uptake (µmol N nitrates)</span>
<span class="sd">        :Returns:</span>
<span class="sd">            delta nitrates (µmol N nitrates)</span>
<span class="sd">        :Returns Type:</span>
<span class="sd">            :class:`float`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">mineralisation</span> <span class="o">-</span> <span class="n">uptake_nitrates</span> <span class="o">*</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SoilParameters</span><span class="o">.</span><span class="n">CULM_DENSITY</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">CN-Wheat 0.0.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, C.Chambon and R.Barillot.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>